<!-- by: AngelMqz and colaboration: annonxroot -->
<html>
  <link rel="stylesheet"  href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css?family=Alatsi" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/dev/aframe/build/aframe-ar.js"></script>
  <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.0.5/gsap.min.js"></script>
  <script src="https://unpkg.com/merge-images"></script>
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet" />
  <script src="app/package/js/swiper.min.js"></script>
  <link rel="stylesheet" href="app/package/css/swiper.min.css" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="mobile-web-app-capable" content="yes" />
  <link rel="stylesheet"  href="css/style-ar.css">
  <script languague="javascript">
    function mostrar() {
      div = document.getElementById("flotante");
      div.style.display = "";
    }

    function cerrar() {
      div = document.getElementById("flotante");
      div.style.display = "none";
    }
  </script>
  <div class="box3 white div-s">
    <div class="swiper-container">
      <div class="swiper-wrapper">
        <div class="swiper-slide">
          <img class="rounded-circle"  src="app/logo.png" width="60px" height="60px"/>
        </div>

        <div class="swiper-slide">
          <a title="" id="bt2" href="CASAVIEJA RESTAURANTE.html">
            <img class="img" src="app/casavieja/comida5.png"/>
          </a>
        </div>
        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE1.html">
            <img class="img" src="app/casavieja/comida1.png"/>
          </a>
        </div>
        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE2.html">
            <img class="img" src="app/casavieja/comida3.png"/>
          </a>
        </div>

        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE3.html">
            <img class="img" src="app/casavieja/comida6.png"/>
          </a>
        </div>
        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE4.html">
            <img class="img" src="app/casavieja/comida4.png"/>
          </a>
        </div>
        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE5.html">
            <img class="img" src="app/casavieja/comida2.png"/>
          </a>
        </div>
        <div class="swiper-slide">
          <a title="" href="CASAVIEJA RESTAURANTE6.html">
            <img class="img" src="app/casavieja/comida7.png"/>
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="div-s-r">
    <div class="box white">
      <p class="p-s-1">Hot Dog Hawaino.</p>
      <p align="center" class="p-s-2">$45.00</p>
      <br />
      <a href="javascript:mostrar();">
        Detalles<i class="fas fa-sort-down"></i>
      </a>
      <div id="flotante" style="display: none;">
        <div class="box2 white" id="close">
          <a href="javascript:cerrar();"><i class="fas fa-sort-up"></i></a>
          <p>Jam&oacute;n, pi√±a y queso.</p>
        </div>
      </div>
    </div>
  </div>
  <div  class="div-s-r-1">
    <button style="font-size: 60px;" class="button" id="snap-button">
      <i class="material-icons" style="font-size: 85%; position: center; text-align: center;">
        add_circle_outline
      </i>
    </button>
    <a id="download-link" href="#"></a>
    <a href="page-main.html">
      <img class="fle img-s" src="app/return.png"/>
    </a>
      <img class="img-s-1" src="assets/share.png"/>  
    </a>
  </div>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />
  <body style="margin: 0px; overflow: hidden; width: 100%;">
  <a-scene embedded arjs="debugUIEnabled: false;" vr-mode-ui="enabled: false">
  <!-- AR marker-->
   <a-marker preset="custom" type="pattern"  url="app/assets/pattern-frame.patt">
    <!--Tarjet for look dish-->
    <!-- image to open in AR -->
    <a-entity camera look-controls >
    <a-image width="4.3" height="2.6" src="app/casavieja/comida6.png"></a-image>
    </a-entity>
    <!-- end model AR-->
    <!-- take a picture-->
    <script>
          var m = document.querySelector("a-marker");
          m.addEventListener("markerFound", (e) => {
            console.log("found");
            var v = document.querySelector("#mivideo").play();
          });
          m.addEventListener("markerLost", (e) => {
            console.log("lost");
            var v = document.querySelector("#mivideo").play();
          });

          function resizeCanvas(origCanvas, width, height) {
            let resizedCanvas = document.createElement("canvas");
            let resizedContext = resizedCanvas.getContext("2d");

            resizedCanvas.height = height;
            resizedCanvas.width = width;

            resizedContext.drawImage(origCanvas, 0, 0, width, height);
            return resizedCanvas.toDataURL();
          }

          document
            .getElementById("snap-button")
            .addEventListener("click", function () {
              let aScene = document
                .querySelector("a-scene")
                .components.screenshot.getCanvas("perspective");
              let frame = captureVideoFrame("video", "png");
              aScene = resizeCanvas(aScene, frame.width, frame.height);
              frame = frame.dataUri;

              mergeImages([frame, aScene]).then((b64) => {
                let link = document.getElementById("download-link", "jpeg");
                link.setAttribute("download", "AR.jpeg");
                link.setAttribute("href", b64);
                link.click();
                console.log("foto tomada");
              });
            });

          function captureVideoFrame(video, format, width, height) {
            if (typeof video === "string") {
              video = document.querySelector(video);
            }

            format = format || "jpeg";

            if (!video || (format !== "png" && format !== "jpeg")) {
              return false;
            }

            var canvas = document.createElement("CANVAS");

            canvas.width = width || video.videoWidth;
            canvas.height = height || video.videoHeight;
            canvas.getContext("2d").drawImage(video, 0, 0);
            var dataUri = canvas.toDataURL("image/" + format);
            var data = dataUri.split(",")[1];
            var mimeType = dataUri.split(";")[0].slice(5);

            var bytes = window.atob(data);
            var buf = new ArrayBuffer(bytes.length);
            var arr = new Uint8Array(buf);

            for (var i = 0; i < bytes.length; i++) {
              arr[i] = bytes.charCodeAt(i);
            }

            var blob = new Blob([arr], { type: mimeType });
            return {
              blob: blob,
              dataUri: dataUri,
              format: format,
              width: canvas.width,
              height: canvas.height,
            };
          }
        </script>
       <!--end take a picture-->
      </a-marker>
      <!--end take a picture-->
      <a-entity camera></a-entity>
      <!--start attribute with the AR -->
    </a-scene>
    <!--end scene AR -->
  </body>
  <script>
    var swiper = new Swiper(".swiper-container", {
      slidesPerView: 5,
      spaceBetween: 50,
      slidesPerGroup: 5,
      loop: true,
      loopFillGroupWithBlank: true,
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
    });
  </script>
</html>
